<div id="admin-page-viewDevis">
    <div id="admin-blocs-panierHeader" class="border-bottom">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item">
              <a class="fil-ariane-item" href="/admin/devis">Commandes</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
              <a href="#" class="link-panier">N° <%= commande.com_id %></a>
            </li>
          </ol>
        </nav>
        <div class="produit-menu">
          <h1>Devis N° <%= commande.com_id %> de <%= commande.Client.Titre.tit_libelle %> <%= commande.Client.cli_nom %></h1>
          <div class="produit-menu-btn">
            <button type="button" class="btn btn-outline-secondary">Aide</button>
          </div>
        </div>
    </div>
    <div class="actions">
        <select class="form-select" aria-label="Default select example">
            <option selected>Finalisation du dévis</option>
            <option value="1">One</option>
            <option value="2">Two</option>
            <option value="3">Three</option>
        </select>
        <button type="button" class="btn btn-secondary shadow">Mettre à jour l'état</button>
        <button type="button" class="btn     shadow"><i class="fa-solid fa-print"></i> Imprimer le dévis</button>
        <button type="button" class="btn btn-light shadow"><i class="fa-solid fa-envelope"></i> Envoyer le dévis</button>
        <button type="button" class="btn btn-light shadow"><i class="fa-solid fa-print"></i> Imprimer le bon d'essayage</button>
        <button type="button" class="btn btn-light shadow"><i class="fa-solid fa-envelope"></i>Envoyer le bon d'essayage</button>
    </div>
    <div class="content">
        <div class="left">
            <div class="card shadow bloc-client">
                <h3 class="bloc-client-title">Client</h3>
                <div class="bloc-client-name">
                    <p><i class="fa-solid fa-id-card"></i> <span>M Eric Guermah</span></p>
                    <a href="">Plus de details</a>
                </div>
                <div class="row bloc-client-info">
                    <div class="col-md-12">
                        <div>
                            <h2>E-mail :</h2>
                            <p>eric.guermah@gmail.com</p>
                        </div>
                        <div>
                            <h2>Compte créé :</h2>
                            <p>eric.guermah@gmail.com</p>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div>
                            <h2>Commande validées :</h2>
                            <p>0</p>
                        </div>
                        <div>
                            <h2>Total dépensé depuis inscription :</h2>
                            <p></p>
                        </div>
                    </div>
                </div>
                <div class="row bloc-client-adresse">
                    <div class="col-md-5 adresse-item">
                        <div>
                            <h2>
                                <span>Adresse de livraison</span>
                                <div class="dropdown">
                                    <i
                                    class="fa-solid dropdown-toggle fa-ellipsis-vertical"
                                    type="button"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false"
                                    id="dropdownadress-1"
                                  ></i>
                                    <ul class="dropdown-menu" aria-labelledby="dropdownadress-1">
                                      <li><a class="dropdown-item" href="#">Modifier une adresse existante</a></li>
                                      <li><a class="dropdown-item" href="#">Sélectionner une autre adresse</a></li>
                                    </ul>
                                </div>
                            </h2>
                            <p>Eric Guermah</p>
                            <p>5, rue des agaces</p>
                        </div>
                    </div>
                    <div class="col-md-5 offset-2 adresse-item">
                        <div>
                            <h2>
                                <span>Adresse de facturation</span>
                                <div class="dropdown">
                                    <i
                                    class="fa-solid dropdown-toggle fa-ellipsis-vertical"
                                    type="button"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false"
                                    id="dropdownadress-2"
                                  ></i>
                                    <ul class="dropdown-menu" aria-labelledby="dropdownadress-2">
                                      <li><a class="dropdown-item" href="#">Modifier une adresse existante</a></li>
                                      <li><a class="dropdown-item" href="#">Sélectionner une autre adresse</a></li>
                                    </ul>
                                </div>
                            </h2>
                            <p>Eric Guermah</p>
                            <p>5, rue des agaces</p>
                        </div>
                    </div>
                </div>
                <div class="bloc-client-commentaire">
                    <h2>Commentaire privé</h2>
                    <p><i class="fa-solid fa-plus"></i></p>
                </div>
            </div>
            <div class="card shadow bloc-adresse">
                <h2 class="bloc-adresse-title">Dates (5)</h2>
                <div class="bloc-adresse-content">
                    <div class="bloc-adresse-content-spectacle">
                        <h2>Date de spectacle</h2>
                        <div class="date-spectacle-debut">27/01/2023</div>
                        <div class="date-spectacle-fin">28/01/2023</div>
                    </div>
                    <div class="bloc-adresse-content-repetition">
                        <h2  data-bs-toggle="modal" data-bs-target="#modal-add-essayage">
                            <span>Date de répétition</span>
                            <span><i class="fa-solid fa-plus"></i></span>
                        </h2>
                        <div class="date-repetition-item">
                            <span>27/01/2023</span>
                            <span class="date-repetition-item-trash"><i class="fa-solid fa-trash"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="right">
            <div class="card shadow produit-list">
                <h2 class="produit-list-title">Produit (<%= commande.Panier.Panier_details.length %>)</h2>
                <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">Produit</th>
                        <th scope="col">Statut</th>
                        <th scope="col">Prix unitaire</th>
                        <th scope="col">Quantité</th>
                        <th scope="col">Disponible</th>
                        <th scope="col">Remise</th>
                        <th scope="col">Total</th>
                        <th scope="col">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                        <% commande.Panier.Panier_details.forEach(panier_detail => { %>
                            <tr>
                                <th scope="row" class="tr-th-produit">
                                    <div>
                                        <div class="tr-th-produit-img">
                                            <img src="/images/produits/<%= panier_detail.Produit.Media[0].med_ressource  %>" alt="">
                                        </div>
                                        <div class="tr-th-produit-text">
                                            <p><%= panier_detail.Produit.pro_libelle  %></p>
                                        </div>
                                    </div>
                                </th>
                                <td>Mark</td>
                                <td><%= panier_detail.pad_ttc.toString().replace('.', ',') %>€</td>
                                <td><%= panier_detail.pad_qte %></td>
                                <% var sum = 0 %>
                                <% panier_detail.Produit.Quantites.forEach(qte => sum = sum + qte['qua_nbre'])%>
                                <td><%= sum %></td>
                                <td>
                                    <% if (panier_detail.Produit.Applies.length === 0) { %>
                                        <span class="btn btn-remise-prod" data-pad="<%= panier_detail.pad_id %>">
                                            Ajouter une remise sur le produit
                                        </span>
                                    <% } else { %>
                                        <span>Remise</span>
                                    <% } %>
                                <td><%= panier_detail.pad_ttc * panier_detail.pad_qte %>€</td>
                                <td>
                                    <button class="btn btn-primary btn-edit-prod" data-pad="<%= panier_detail.pad_id %>">
                                        <i data-pad="<%= panier_detail.pad_id %>" class="fa-solid fa-pencil"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr class="tr-form-edit-prod <%= "tr-form-edit-prod-"+panier_detail.pad_id%> ">
                                <td colspan="8" class="form-edit-prod" >
                                    <div>
                                        <form class="row g-3">
                                            <div class="col-auto">
                                              <input type="text" readonly class="form-control">
                                            </div>
                                            <div class="col-auto">
                                              <input type="text" class="form-control">
                                            </div>
                                            <div class="col-auto">
                                              <button type="submit" class="btn btn-primary mb-3">Modifier</button>
                                            </div>
                                        </form>
                                    </div>
                                </td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
                <div class="table-actions">
                    <div class="item-par-page">
                        <p>Elements par page : </p>
                        <div class="input-group">
                            <input type="number" class="form-control" value="50">
                        </div>
                    </div>
                    <div class="buttons">
                        <button type="button" class="btn btn-light"><i class="fa-solid fa-plus"></i>Ajouter un produit</button>
                        <button type="button" class="btn btn-light"><i class="fa-solid fa-plus"></i>Ajouter une reduction</button>
                    </div>
                </div>
                <div class="table-resume">
                    <div>
                        <h2>Produits</h2>
                    </div>
                    <div>
                        <h2>Réductions</h2>
                    </div>
                    <div>
                        <h2>Livraison</h2>
                    </div>
                    <div>
                        <h2>Autres Frais</h2>
                    </div>
                    <div>
                        <h2>Taxes</h2>
                    </div>
                    <div>
                        <h2>Total</h2>
                    </div>
                </div>
            </div>
            <div class="devis-note">
                <h2>Note de devis</h2>
                <form action="">
                    <div class="mb-3">
                        <textarea class="simplemde" id="devis-note-textarea" cols="30" rows="5"></textarea>
                    </div>
                    <div class="devis-note-form-action">
                        <p>Afficher cette note de commande sur la facture <input type="checkbox" name="" id=""></p>
                        <button class="btn btn-light">Sauver</button>
                    </div>
                </form>
            </div>
            <div class="commande-tabs">
                <nav>
                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <button class="nav-link active" id="nav-etat-tab" data-bs-toggle="tab" data-bs-target="#nav-etat" type="button" role="tab" aria-controls="nav-home" aria-selected="true"><i class="fa-solid fa-clock-rotate-left"></i>Etat</button>
                        <button class="nav-link" id="nav-document-tab" data-bs-toggle="tab" data-bs-target="#nav-document" type="button" role="tab" aria-controls="nav-profile" aria-selected="false"><i class="fa-solid fa-file"></i> Documents (2)</button>
                        <button class="nav-link" id="nav-transporteur-tab" data-bs-toggle="tab" data-bs-target="#nav-transporteur" type="button" role="tab" aria-controls="nav-contact" aria-selected="false"><i class="fa-solid fa-truck"></i> Transporteurs (1)</button>
                        <button class="nav-link" id="nav-retour-tab" data-bs-toggle="tab" data-bs-target="#nav-retour" type="button" role="tab" aria-controls="nav-contact" aria-selected="false"><i class="fa-solid fa-arrow-rotate-left"></i> Retour produits</button>
                    </div>
                </nav>
                <div class="tab-content card" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-etat" role="tabpanel" aria-labelledby="nav-etat-tab">
                        <div class="nav-etat-items">
                            <div class="nav-etat-item">
                                <div class="etat-label">
                                    <p>Générer le bon d'essayage</p>
                                </div>
                                <div class="etat-user">
                                    <p>DELPHINE GUERMAH</p>
                                </div>
                                <div class="etat-date">
                                    <p>26/04/2023</p>
                                </div>
                                <div class="etat-action">
                                    <p><i class="fa-solid fa-trash"></i></p>
                                </div>
                            </div>
                        </div>
                        <div class="nav-etat-actions">
                            <div class="select-etat">
                                <select class="form-select" aria-label="Default select example">
                                    <option selected>Générer le bon d'essayage</option>
                                    <option value="1">One</option>
                                    <option value="2">Two</option>
                                    <option value="3">Three</option>
                                </select>
                            </div>
                            <button class="btn btn-light">Mettre à jour</button>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-document" role="tabpanel" aria-labelledby="nav-document-tab">
                        <table class="table">
                            <thead>
                              <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Document</th>
                                <th scope="col">Numéro</th>
                                <th scope="col">Montant</th>
                                <th scope="col">Actions</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>Otto</td>
                                <td>@mdo</td>
                                <td>
                                    <div>
                                        <button class="btn btn-primary btn-form-doc-paiement">Saisir un paiement</button>
                                        <button class="btn btn-primary btn-form-doc-note">Saisir une note</button>
                                        <button class="btn btn-light"><i class="fa-solid fa-trash"></i></button>
                                    </div>
                                </td>
                              </tr>
                             <tr class="tr-form-note">
                                <td colspan="5">
                                    <form class="row g-3">
                                        <div class="col-auto">
                                            <textarea class="form-control" id="" cols="30" rows="10"></textarea>
                                        </div>
                                        <div class="col-auto">
                                          <button type="submit" class="btn btn-primary mb-3">Enregistrer</button>
                                        </div>
                                    </form>
                                </td>
                              </tr>
                              <tr class="tr-form-paiement">
                                <td colspan="5">
                                    <form class="row g-3">
                                        <div class="col-auto">
                                          <input type="text" class="form-control">
                                        </div>
                                        <div class="col-auto">
                                          <input type="text" class="form-control">
                                        </div>
                                        <div class="col-auto">
                                          <button type="submit" class="btn btn-primary mb-3">Enregistrer</button>
                                        </div>
                                    </form>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                    </div>
                    <div class="tab-pane fade" id="nav-transporteur" role="tabpanel" aria-labelledby="nav-transporteur-tab">
                        <table class="table">
                            <thead>
                              <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Transporteur</th>
                                <th scope="col">Poids</th>
                                <th scope="col">Frais  d'expedition</th>
                                <th scope="col">Numéro de suivi</th>
                                <th scope="col">Action</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>Otto</td>
                                <td>@mdo</td>
                                <td>@mdo</td>
                                <td>@mdo</td>
                              </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="tab-pane fade" id="nav-retour" role="tabpanel" aria-labelledby="nav-retour-tab">
                        <table class="table">
                            <thead>
                              <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Produit</th>
                                <th scope="col" class="th-quantite">
                                    <div>
                                        <p>Quantité</p>
                                        <div>
                                            <p>En location</p>
                                            <p>En retour</p>
                                        </div>
                                    </div>
                                </th>
                                <th scope="col">Etat</th>
                                <th scope="col">Actions</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>Otto</td>
                                <td>@mdo</td>
                                <td>@mdo</td>
                              </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="paiements-bloc card shadow">
                <h2>Paiement (0)</h2>
                <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">Date</th>
                        <th scope="col">Moyen de paiement</th>
                        <th scope="col">ID de la transaction</th>
                        <th scope="col">Montant</th>
                        <th scope="col">Facture</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row">1</th>
                        <td>Mark</td>
                        <td>Otto</td>
                        <td>@mdo</td>
                        <td>@mdo</td>
                      </tr>
                    </tbody>
                </table>
                <div class="form-bloc-paiement">
                    <form class="row g-3">
                        <div class="col-auto">
                            <input type="date" class="form-control" name="" id="">
                        </div>
                        <div class="col-auto">
                            <select class="form-select" aria-label="Default select example">
                                <option selected>Moyen de paiement</option>
                                <option value="1">One</option>
                                <option value="2">Two</option>
                                <option value="3">Three</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <input type="text" class="form-control" name="" id="" placeholder="ID de la transaction">
                        </div>
                        <div class="col-auto">
                            <input type="text" class="form-control" name="" id="" placeholder="Montant">
                        </div>
                        <div class="col-auto">
                            <select class="form-select" aria-label="Default select example">
                                <option selected>Facture</option>
                                <option value="1">One</option>
                                <option value="2">Two</option>
                                <option value="3">Three</option>
                            </select>
                        </div>
                        <div class="col-auto">
                          <button type="submit" class="btn btn-primary mb-3">Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal-add-essayage" tabindex="-1" aria-labelledby="modal-essayage-label" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modal-essayage-label">Ajouter une date d'essaye pour cette commande</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form action="" method="post">
            <div class="modal-body">
                <div class="mb-3">
                    <label for="input-add-adresse" class="form-label">Adresse</label>
                    <input type="date" class="form-control" id="input-add-adresse" placeholder="name@example.com">
                  </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">annuler</button>
                <button type="submit" class="btn btn-primary">Ajouter</button>
            </div>
        </form>
      </div>
    </div>
</div>
<script src="/javascripts/admin/devis.view.js"></script>